<!DOCTYPE html>
<html>
<head>
  <title>Flashing Dot</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body onload="updater()">
  <div id="disclaimerBox">
    WARNING: THIS PROGRAM CONTAINS FLASHING LIGHTS WHICH MAY NOT BE SUITABLE FOR PEOPLE WITH PHOTOSENSITIVE EPILEPSY.
  </div>
  <div id="content">
    <span class="dot"></span>
  </div>

  <script>
    function updater() {
      setInterval(toggleDisclaimer, 10);
      setInterval(toggleFlash, 10);
      setInterval(changeDotSize, 10);
      setInterval(changeFlashSpeed, 10);
      setInterval(changeDotColor, 250);
      setInterval(changeBackgroundColor, 10);
      setInterval(moveDot, 10);
    }

    function toggleDisclaimer() {
      var disclaimer = localStorage.getItem('disclaimer');
      var disclaimerBox = document.getElementById('disclaimerBox');
      if (disclaimer == 1) {
        disclaimerBox.removeAttribute('hidden');
      } else {
        disclaimerBox.setAttribute('hidden', '');
      }
    }

    function toggleFlash() {
      var dot = document.querySelector('.dot');
      var flashing = localStorage.getItem('flashing');
      if (flashing == 0) {
        dot.classList.remove('flash');
      } else {
        dot.classList.add('flash');
      }
    }

    function changeDotSize() {
      var dot = document.querySelector('.dot');
      var sizeInput = localStorage.getItem('size');
      dot.style.width = sizeInput + 'px';
      dot.style.height = sizeInput + 'px';
    }

    function changeFlashSpeed() {
      var dot = document.querySelector('.dot');
      var speedInput = localStorage.getItem('speed');
      dot.style.animationDuration = speedInput + 'ms';
    }

function changeDotColor() {
  var dot = document.querySelector('.dot');
  var color = localStorage.getItem('dotColor');

  // Only apply color change if there is an actual change in the color value
  if (dot.style.backgroundColor !== color) {
    dot.style.backgroundColor = color;
  }
}

    function changeBackgroundColor() {
      var body = document.querySelector('body');
      var color = localStorage.getItem('backColor');
      body.style.backgroundColor = color;
    }

    function moveDot() {
      var dot = document.querySelector('.dot');
      var x = localStorage.getItem('x');
      var y = localStorage.getItem('y');
      console.log(x);
      dot.style.left = x + 'px';
      dot.style.top = y + 'px';
    }
  </script>
</body>
</html>
